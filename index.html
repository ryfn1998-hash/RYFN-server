<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>星河伺服器 - 全方位監控面板</title>
    <style>
        body { background-color: #0d0d0d; color: white; font-family: monospace; margin: 0; padding: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { border: 1px solid #333; background: #161616; padding: 20px; border-radius: 4px; }
        .title { color: #72bd44; font-weight: bold; border-bottom: 1px solid #72bd44; padding-bottom: 5px; margin-bottom: 15px; }
        .data-value { color: #72bd44; font-size: 1.2rem; }
        .log { background: #000; height: 300px; overflow-y: auto; padding: 10px; font-size: 0.85rem; color: #888; border: 1px solid #222; }
        .warning { color: #ff4444; }
    </style>
</head>
<body>
    <h2 style="color: #72bd44;">SERVER MONITORING: ryfn.falix.gg</h2>
    <div class="grid">
        <div class="card">
            <div class="title">SYSTEM STATUS</div>
            <p>伺服器網址: ryfn.falix.gg</p>
            <p>連線狀態: <span id="status" class="data-value">SCANNING...</span></p>
            <p>目前人數: <span id="players" class="data-value">- / -</span></p>
            <p>更新倒數: <span id="timer">30</span>s</p>
        </div>

        <div class="card">
            <div class="title">PLAYER SCANNER</div>
            <div id="player-list">等待 API 回傳公開名單...</div>
            <p class="warning" style="font-size: 0.75rem;">註: 座標與裝備數據因無後台 RCON 權限暫時無法擷取</p>
        </div>
    </div>

    <div class="card" style="margin-top: 20px;">
        <div class="title">ACTIVITY LOG (歷史掃描紀錄)</div>
        <div class="log" id="log-box">正在初始化日誌系統...</div>
    </div>

    <script>
        async function checkServer() {
            const logBox = document.getElementById('log-box');
            try {
                const res = await fetch('https://api.mcsrvstat.us/2/ryfn.falix.gg');
                const data = await res.json();
                const time = new Date().toLocaleTimeString();

                if (data.online) {
                    document.getElementById('status').innerText = "ONLINE";
                    document.getElementById('players').innerText = `${data.players.online} / ${data.players.max}`;
                    document.getElementById('player-list').innerText = data.players.list ? data.players.list.join(', ') : "無公開玩家名單";
                    logBox.innerHTML = `[${time}] 掃描成功: 在線人數 ${data.players.online}<br>` + logBox.innerHTML;
                } else {
                    document.getElementById('status').innerText = "OFFLINE";
                    document.getElementById('status').classList.add('warning');
                    logBox.innerHTML = `<span class="warning">[${time}] 警告: 伺服器失去連線</span><br>` + logBox.innerHTML;
                }
            } catch (e) {
                logBox.innerHTML = `<span class="warning">[錯誤] 無法擷取 API 數據</span><br>` + logBox.innerHTML;
            }
        }

        // 倒數計時與自動刷新
        let count = 30;
        setInterval(() => {
            count--;
            document.getElementById('timer').innerText = count;
            if (count <= 0) {
                checkServer();
                count = 30;
            }
        }, 1000);

        checkServer();
    </script>
</body>
</html>
